const l="CG-6fF1XY7ErEgcxWvy3cx4CkMj";chrome.runtime.onInstalled.addListener(()=>{console.log("Crypto Monitor extension installed"),chrome.alarms.create("priceCheck",{delayInMinutes:1,periodInMinutes:1})});chrome.alarms.onAlarm.addListener(async s=>{if(s.name==="priceCheck"){const{alerts:i}=await chrome.storage.sync.get("alerts");if(i&&Array.isArray(i)&&i.length>0){const t=[...new Set(i.map(c=>c.coinId))];try{const a=await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${t.join(",")}&vs_currencies=usd&x_cg_demo_api_key=${l}`)).json();i.forEach(e=>{var r;const o=(r=a[e.coinId])==null?void 0:r.usd;if(o){let n=!1;if(e.condition==="above"&&o>e.price&&(n=!0),e.condition==="below"&&o<e.price&&(n=!0),n){chrome.notifications.create({type:"basic",iconUrl:"icons/icon48.png",title:"Price Alert",message:`${e.coinId} is ${e.condition} ${e.price}`});const d=i.filter(p=>p.id!==e.id);chrome.storage.sync.set({alerts:d})}}})}catch(c){console.error("Error checking prices:",c)}}}});
